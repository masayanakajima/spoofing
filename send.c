#include <pcap.h>
#include <string.h>
#include <stdio.h>
#include <stdlib.h>
#include <unistd.h>
#include "hacking.h"

char errbuf[PCAP_ERRBUF_SIZE];
pcap_t *pcap_handle;

void caught_packet(u_char*,const struct pcap_pkthdr*,const u_char*);
void *send_poison(void*);
void generate_arp_pkt(struct arp_packet*,u_char*,u_char*,u_char*,u_char*);

int main(int argc,char** argv){

    pcap_handle=pcap_open_live("vboxnet0",4096,1,0,errbuf);
    char packet[74]={
	0x08, 0x00, 0x27, 0x59, 0x5e, 0xae, 0x0a, 0x00, /* ..'Y^... */
0x27, 0x00, 0x00, 0x00, 0x08, 0x00, 0x45, 0x00, /* '.....E. */
0x00, 0x3c, 0xcd, 0x58, 0x40, 0x00, 0x40, 0x06, /* .<.X@.@. */
0x7b, 0x47, 0xc0, 0xa8, 0x38, 0x66, 0xc0, 0xa8, /* {G..8f.. */
0x38, 0x65, 0xb8, 0x08, 0x00, 0x50, 0x0c, 0xe3, /* 8e...P.. */
0x46, 0xd4, 0x00, 0x00, 0x00, 0x00, 0xa0, 0x02, /* F....... */
0x72, 0x10, 0x49, 0x04, 0x00, 0x00, 0x02, 0x04, /* r.I..... */
0x05, 0xb4, 0x04, 0x02, 0x08, 0x0a, 0x00, 0x4d, /* .......M */
0x8e, 0x72, 0x00, 0x00, 0x00, 0x00, 0x01, 0x03, /* .r...... */
0x03, 0x07                                     /* 67 */
};

    pcap_sendpacket(pcap_handle,packet,200);
    pcap_loop(pcap_handle,-1,caught_packet,NULL);
    
    return 1;
}

void caught_packet(u_char* user_args,const struct pcap_pkthdr* cap_header,const u_char* packet){
	dump(packet,100);
}


